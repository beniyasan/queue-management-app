# ドラッグ&ドロップによるパーティー参加者順番入れ替え機能 - 要件定義書

## 1. 機能概要

パーティー参加者リスト内のユーザーの順番をドラッグ&ドロップで直感的に入れ替えできる機能を実装する。

## 2. 機能要件

### 2.1 基本機能
- パーティー参加者リスト内のユーザー要素をドラッグ可能にする
- ドラッグ中の視覚的フィードバックを提供する
- ドロップ時に順番を入れ替える
- 順番変更後、データベースに新しい順番を保存する

### 2.2 対象範囲
- **対象**: パーティー参加者リストのみ（キュー待機者リストは対象外）
- **利用可能ユーザー**: 管理者（セッション作成者）のみ
- **対象画面**: 管理者画面のパーティー参加者リスト

### 2.3 制約事項
- 固定ユーザー（isFixed: true）も移動可能とする
- モバイル端末でもタッチ操作で利用可能にする
- リアルタイムで他のユーザーに反映される

## 3. ユーザーインターフェース要件

### 3.1 視覚的フィードバック
- ドラッグ可能な要素にカーソルを合わせた時、ドラッグ可能であることを示す（カーソル変更）
- ドラッグ中の要素は半透明になる
- ドロップ可能な位置を視覚的に示す（プレースホルダーまたはガイドライン）

### 3.2 操作性
- マウスでのドラッグ&ドロップに対応
- タッチデバイスでのドラッグ&ドロップに対応
- ドラッグ中にスクロールが必要な場合は自動スクロール

## 4. データ管理要件

### 4.1 順番の保存
- 順番変更時、各ユーザーの`order_index`を更新
- Supabaseデータベースに即座に保存
- 保存エラー時は元の順番に戻す

### 4.2 同期
- 順番変更はリアルタイムで全ユーザーに反映
- 既存のリアルタイム同期機能を利用

## 5. 非機能要件

### 5.1 パフォーマンス
- ドラッグ&ドロップ操作は滑らかに動作（60fps目標）
- データベース更新は非同期で実行

### 5.2 互換性
- 主要なモダンブラウザで動作（Chrome, Firefox, Safari, Edge）
- モバイルブラウザでも動作（iOS Safari, Chrome for Android）

### 5.3 アクセシビリティ
- キーボード操作でも順番変更可能（オプション）

## 6. 実装上の考慮事項

- 既存のユーザーリスト表示機能を拡張
- 既存のデータ構造（order_index）を活用
- 既存のスタイルを維持しつつ、ドラッグ時のスタイルを追加